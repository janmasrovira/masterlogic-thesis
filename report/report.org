#+latex_compiler: xelatex
#+latex_class: article
#+title: Interpretability logics
#+author: Jan Mas Rovira
#+subtitle: Master's thesis

#+latex_header: \usepackage{unicode-math}
#+latex_header: \usepackage{fontspec}
#+latex_header: \usepackage[x11names, table]{xcolor}
#+latex_header: \usepackage[margin=2.5cm]{geometry}
#+latex_header: \usepackage{lmodern}
#+latex_header: \setmonofont{FreeMono}
#+latex_header: \usepackage{cancel}
#+latex_header: \usepackage{amsthm}

#+latex_header: \hypersetup{colorlinks=true,urlcolor=DodgerBlue4,linkcolor=Firebrick4,citecolor=Green4}
#+latex_header: \newcommand{\ie}[0]{i.e.\ }
#+latex_header: \newcommand{\todo}[0]{\textcolor{red}{pending}}
#+latex_header: \newcommand{\pend}[0]{\textcolor{Tomato3}{pending }}
#+latex_header: \newcommand{\ok}[0]{\textcolor{DeepSkyBlue4}{solved }}
#+macro: red @@latex:{\color{red}@@$1@@latex:}@@

#+macro: begindef @@latex:\begin{definition}@@
#+macro: enddef @@latex:\end{definition}@@

#+macro: begincoro @@latex:\begin{corollary}@@
#+macro: endcoro @@latex:\end{corollary}@@

#+macro: begintheorem @@latex:\begin{theorem}@@
#+macro: endtheorem @@latex:\end{theorem}@@

#+macro: beginproof @@latex:\begin{proof}@@
#+macro: endproof @@latex:\end{proof}@@


#+latex_header: \newtheorem{theorem}{Theorem}
#+latex_header: \theoremstyle{definition}
#+latex_header: \newtheorem{corollary}[theorem]{Corollary}
#+latex_header: \theoremstyle{definition}
#+latex_header: \newtheorem{definition}[theorem]{Definition}
#+latex_header: \graphicspath{{img/}}

* Language
  The language of interpretability logics is $âŸ¨âŠ¥,â†’,â–·âŸ©$. We define $âˆ§,â–¡,â™¢,âˆ¨$.

* Notation
  Is this intuitive enough that is not even worth mentioning?
  - $wRuRv$ iff $wRu$ and $uRv$.
  - $wRuS_xv$ iff $wRu$ and $uS_xv$.
  - $wRuâŠ©A$ iff $wRu$ and $uâŠ©A$.
  - $YâŠ©A$ iff for all $yâˆˆY$ we have $yâŠ©A$.
  - $xS_wYâŠ©A$ iff $xS_wY$ and $YâŠ©A$.
* Semantics
  In this document we consider two variants of relational semantics for
  interpretability logic similar to Kripke semantics for modal logic.

** Ordinary Veltman semantics
   {{{begindef}}} An ordinary Veltman frame $F=âŸ¨W,R,SâŸ©$ is a structure
   constituted by a set of worlds $W$, a binary relation $RâŠ†WÂ²$ and a ternary
   relation $SâŠ†WÃ—WÃ—W$. We write $wRu$ in place of $âŸ¨w,uâŸ©âˆˆR$ and
   $uS_wv$ in place of $âŸ¨w,u,vâŸ©âˆˆS$. The structure must satisfy the following
   conditions:

   1. $R$ is a transitive.
   2. $R$ is conversely well-founded. That is, there is no infinite ascending
      chain $wâ‚Rwâ‚‚Râ€¦$.
   3. If $uS_wv$ then $wRu$ and $wRv$.
   4. If $wRu$ then $uS_wu$.
   5. For every $w$, $S_w$ is transitive.
   6. If $wRu$ and $uRv$ then $uS_wv$.
   {{{enddef}}}


   {{{begindef}}} An ordinary Veltman model $M=âŸ¨F,VâŸ©$ is a structure constituted
   by an ordinary Veltman frame $F$ and a valuation $VâŠ†WÃ—Var$.

   Given a model $M$, we define a forcing relation $âŠ©_MâŠ†W Ã— Fm$. We write
   $M,wâŠ©A$ in place of $âŸ¨w,AâŸ©âˆˆâŠ©_M$ or simply $wâŠ©A$ when the model is clear by
   the context. We write $wâŠ®A$ when $âŸ¨w,AâŸ©âˆ‰âŠ©_M$.
   - $wâŠ®âŠ¥$.
   - If $xâˆˆVar$, then $wâŠ©x$ iff $âŸ¨w,xâŸ©âˆˆV$.
   - If $A,BâˆˆFm$, then $wâŠ©Aâ†’B$ iff if $wâŠ©A$ then $wâŠ©B$.
   - If $A,BâˆˆFm$, then $wâŠ©Aâ–·B$ iff if $wRu$ and $uâŠ©A$ then there exists $v$ such
     that $vâŠ©B$ and $uS_wv$.
   {{{enddef}}}

   {{{begincoro}}}
   It immediately follows that:
   - If $A,BâˆˆFm$, then $wâŠ©Aâˆ§(âˆ¨)B$ iff $wâŠ©A$ and (or) $wâŠ©B$.
   - If $AâˆˆFm$, then $wâŠ©â™¢A$ iff there exists $u$ such that $wRu$ and $uâŠ©A$.
   - If $AâˆˆFm$, then $wâŠ©â–¡A$ iff for every $u$ such that $wRu$ we have $uâŠ©A$.
   {{{endcoro}}}

** Generalized Veltman semantics
   {{{begindef}}} An ordinary Veltman frame $F=âŸ¨W,R,SâŸ©$ is a structure
   constituted by a set of worlds $W$, a binary relation $RâŠ†WÂ²$ and a ternary
   relation $SâŠ†WÃ—WÃ—(ğ’«(W)âˆ–\{âˆ…\})$. We write $wRu$ in place of $âŸ¨w,uâŸ©âˆˆR$ and
   $uS_wY$ in place of $âŸ¨w,u,YâŸ©âˆˆS$. The structure must satisfy the following
   conditions:

   1. $R$ is a transitive.
   2. $R$ is conversely well-founded. That is, there is no infinite ascending
      chain $wâ‚Rwâ‚‚Râ€¦$.
   3. If $uS_wY$ then for all $yâˆˆY$ we have $wRy$.
   4. If $wRu$ then $uS_w\{u\}$.
   5. If $xS_wY$ and $yâˆ‰Z$ and $yS_wZ$ then $wS_wZ$.
   6. If $wRu$ and $uRv$ then $uS_w{v}$.
   7. If $VâŠ†Z$ and $ZâŠ†wR\_$ then $uS_wZ$.
   {{{enddef}}}

   {{{begindef}}} An generalized Veltman model $M=âŸ¨F,VâŸ©$ is a structure
   constituted by a generalized Veltman frame $F$ and a valuation $VâŠ†WÃ—Var$.

   Given a model $M$, we define a forcing relation $âŠ©_MâŠ†W Ã— Fm$. We use the same
   notation conventions as in the ordinary semantics.
   - $wâŠ®âŠ¥$.
   - If $xâˆˆVar$, then $wâŠ©x$ iff $âŸ¨w,xâŸ©âˆˆV$.
   - If $A,BâˆˆFm$, then $wâŠ©Aâ†’B$ iff if $wâŠ©A$ then $wâŠ©B$.
   - If $A,BâˆˆFm$, then $wâŠ©Aâ–·B$ iff if $wRu$ and $uâŠ©A$ then there exists $Y$ such
     that $YâŠ©B$ and $uS_wY$. When we write $YâŠ©B$ we mean that for all $yâˆˆY$ we
     have $yâŠ©B$.
   {{{enddef}}}
* Frafme conditions
  A principle is a schema of formulas that carries some special significance.

  In this section we present a series of principles in conjunction with their
  respective frame conditions for ordinary semantics as well as generalized
  semantics.
** $M$ principle
   The $M$ principle reads as follows:
   \[A â–· B â†’ (A âˆ§ â–¡ C) â–· (B âˆ§ â–¡ C)\]

*** Ordinary semantics
   The frame condition for $M$ for ordinary semantics, name it $M_{ord}$,
   reads as follows:
   \[âˆ€x,w,z,u(xS_w zRu â‡’ xRu)\]

   #+caption: Ordinary frame condition for $M$
   #+name: fig:ord-M-condition
   #+attr_latex: :float t :width 0.20\textwidth :placement [H]
   [[file:wip.png]]

   {{{begintheorem}}} For any ordinary frame $F$, we have that $F$ satisfies the
   $M_{ord}$ condition iff any model based on $F$ forces every instantiation of the $M$
   principle. In symbols:

   \[F âŠ¨ M_{ord} â‡” F âŠ© M\] {{{endtheorem}}}

   {{{beginproof}}}
   - \boxed{â‡’} Let $M$ be a model based on $F$ and let $w$ be any world. Assume
     that $wâŠ©Aâ–·B$ and that there is a world $x$ such that $wRx$ and $xâŠ©Aâˆ§â–¡C$.
     Our aim is to find a world $z$ such that $xS_wzâŠ©Bâˆ§â–¡C$. Since $wRxâŠ©A$ and
     $wâŠ©Aâ–·B$ there is a world $z$ such that $xS_wzâŠ©B$. We now show that $zâŠ©â–¡C$.
     Let $u$ be such that $zRu$, by the frame condition it follows that $xRz$
     and we know $xâŠ©â–¡C$ hence $uâŠ©C$ and thus $zâŠ©â–¡C$. Hence $z$ is the desired
     world.

   - \boxed{â‡} Let $a,b,câˆˆVar$, assume $FâŠ© aâ–·bâ†’(aâˆ§â–¡c)â–·(bâˆ§â–¡c)$. Then for some
     $x,w,u$ we have $xS_wzRu$. Our goal is to prove $xRu$. Consider a model
     such that the following holds (for any formula $A$, we define
     $[A]â‰”\{w:wâŠ©A\}$.
     \begin{flalign*}
     [a] &= \{x\} \\
     [b] &= \{z\} \\
     [c] &= \{v:xRv\} \\
     \end{flalign*}
     We observe that $wâŠ©aâ–·b$ because $a$ is only forced in $x$ and we have
     $xS_wzâŠ©b$. Then it follows that $wâŠ©(aâˆ§â–¡c)â–·(bâˆ§â–¡c)$. It is easy to observe
     that $xâŠ©aâˆ§â–¡c$, furthermore we have that by definition of ordinary frame
     $xS_wzâ‡’wRx$, hence $wRx$ and thus there must exist some $v$ such that
     $xS_wvâŠ©bâˆ§â–¡c$. Since $b$ is only true in $z$ it must be $zâŠ©bâˆ§â–¡c$. Then,
     because $zRu$ we have $uâŠ©c$, therefore $xRu$.
   {{{endproof}}}

*** Generalized semantics
   The frame condition for $M$ for generalized semantics, name it $M_{gen}$,
   reads as follows:

   \[ âˆ€u,w,V(uS_wVâ‡’ Î£V'âŠ†V(uS_wV',âˆ€v'âˆˆV'âˆ€z(v'Rzâ‡’uRz)))\]

   #+caption: Generalized frame condition for $M$
   #+name: fig:gen-M-condition
   #+attr_latex: :float t :width 0.20\textwidth :placement [H]
   [[file:wip.png]]

   {{{begintheorem}}} For any generalized frame $F$, we have that $F$ satisfies the
   $M_{gen}$ condition iff any model based on $F$ forces every instantiation of
   the $M$ principle. In symbols:

   \[F âŠ¨ M_{gen} â‡” F âŠ© M\] {{{endtheorem}}}

   {{{beginproof}}}
   - \boxed{â‡’} Let $M$ be a model based on $F$ and let $w$ be any world. Assume
     that $wâŠ©Aâ–·B$ and that there is a world $x$ such that $wRx$ and $xâŠ©Aâˆ§â–¡C$.
     Our aim is to find a set $Z$ such that $xS_wZâŠ©Bâˆ§â–¡C$. Since $wRxâŠ©A$ and
     $wâŠ©Aâ–·B$ there is set $Z$ such that $xS_wZâŠ©B$. Then by the $M_{gen}$
     condition it follows that there is a world $Z'âŠ†Z$ such that $xS_wZ'$ and
     $âˆ€vâˆˆZ'âˆ€z(vRzâ‡’xRz)$. Now we show $Z'âŠ©â–¡C$. Let $vâˆˆZ'$ and $u$ such that
     $vRu$, by the condition above it follows $xRu$ and since $xâŠ©â–¡C$ we have
     $uâŠ©C$. Hence $Z'$ is the desired set.
   - \boxed{â‡} Let $a,b,câˆˆVar$ and assume $FâŠ©a â–· b â†’ (a âˆ§ â–¡ c) â–· (b âˆ§ â–¡ c)$ and
     $uS_wV$. Assume for a contradiction that $(â‹†)\ âˆ€V'âŠ†V(uSwV'â‡’
     âˆƒvâˆˆV'âˆƒz(vRz,u\cancel{R}z))$. Consider a model satisfying the following
     \begin{flalign*}
     [a] &= \{u\} \\
     [b] &= V \\
     [c] & \{v:uRv\} \\
     \end{flalign*}
     We see that $wâŠ©aâ–·b$ since $a$ is only true in $u$ and we have $uS_wVâŠ©bS$.
     It follows that ${wâŠ©(a âˆ§ â–¡ c)â–·(bâˆ§â–¡c)}$. It is easy to see that $uâŠ©aâˆ§â–¡c$,
     hence there must exist $V'$ such that $uS_wV'âŠ©bâˆ§â–¡c$. Clearly $V'âŠ†V$, hence
     by $(â‹†)$ it follows that there exists $vâˆˆV'$ and $z$ such that $vRz$ and
     $u\cancel{R}z$. By the fact that $vRz$ it follows $zâŠ©c$ and by the fact
     that $u\cancel{R}z$ it follows $zâŠ®c$, which is an absurd.
   {{{endproof}}}
** $R$ principle
   The $R$ principle reads as follows:

   \[A â–· B â†’ (Â¬ (A â–· Â¬C) â–· (B âˆ§ â–¡ C))\]

*** Ordinary semantics
    The $R_{ord}$ condition reads as follows:
    \[âˆ€w,x,y,z(wRxRyS_wzâ‡’âˆ€v(zRvâ‡’yS_xv)) \]

   #+caption: Ordinary frame condition for $R$
   #+name: fig:ord-R-condition
   #+attr_latex: :float t :width 0.20\textwidth :placement [H]
   [[file:wip.png]]

*** Generalized semantics

    We first introduce the concept of choice set

   {{{begindef}}} If $xRy$ we say that a set of worlds $K$ is a choice set for
   $âŸ¨x,yâŸ©$ iff for any $V$ such that $yS_xV$ we have $Vâˆ©Kâ‰ âˆ…$. We denote the
   family of choice sets for $âŸ¨x,yâŸ©$ by $ğ’(x,y)$. Note that this definition
   depends on the frame, but it should always be clear by context.
   {{{enddef}}}

    The $R_{gen}$ condition reads as follows:
    \begin{flalign*}
    &âˆ€w,x,y,Y,K(wRxRyS_wY,Kâˆˆğ’(x,y))   \\
    â‡’& âˆƒY'âŠ†Y(xS_wY',âˆ€y'âˆˆY'âˆ€z(y'Rzâ†’zâˆˆK))
    \end{flalign*}

   #+caption: Generalized frame condition for $R$
   #+name: fig:gen-R-condition
   #+attr_latex: :float t :width 0.20\textwidth :placement [H]
   [[file:wip.png]]

   {{{begintheorem}}}
   For any generalized frame $F$, we have that $F$ satisfies the
   $R_{gen}$ condition iff any model based on $F$ forces every instantiation of
   the $R$ principle. In symbols:

   \[F âŠ¨ R_{gen} â‡” F âŠ© R\]
   {{{endtheorem}}}
   {{{beginproof}}}
   - \boxed{â‡’} Let $M$ be a model based on $F$ assume there is a world $w$ such
     that $wâŠ©Aâ–·B$ and a world $x$ such that $wRx$ and $xâŠ©Â¬(Aâ–·Â¬C)$. We need to
     show that there is a set $Z$ such that $xS_wZâŠ©Bâˆ§â–¡C$. From $xâŠ©Â¬(Aâ–·Â¬C)$ it
     follows that there is a world $y$ such that $xRyâŠ©A$ and $(â‹†)\
     âˆ€V(yS_xVâ‡’âˆƒcâˆˆV(câŠ©C))$. Consider the set $Kâ‰”\{c:câŠ©C,âˆƒV(câˆˆV,yS_xV)\}$. Clearly
     by $(â‹†)$ it follows that $K$ is a choice set for $âŸ¨x,yâŸ©$. By transitivity
     of $R$ we get $wRy$ and since $wâŠ©Aâ–·B$ then there must exist some $Y$ such
     that $yS_wYâŠ©B$. We can now apply the $R_{gen}$ condition and get a $Y'âŠ†Y$
     such that $xS_wY'$ and $(â€ )\ âˆ€y'âˆˆY'âˆ€z(y'Rzâ†’zâˆˆK)$. To show that $Y'$ is the
     desired set it remains to see that $Y'âŠ©Bâˆ§â–¡C$. From the fact that $Y'âŠ†YâŠ©B$
     it easily follows that $Y'âŠ©B$. Now, let $y'âˆˆY'$ and $u$ such that $y'Ru$,
     from $(â€ )$ we get $uâˆˆK$ and by definition of $K$ we have $uâŠ©C$.
   - \boxed{â‡} Let $a,b,câˆˆVar$ and assume $FâŠ© a â–· b â†’ (Â¬ (a â–· Â¬c) â–· (b âˆ§ â–¡ c))$.
   {{{endproof}}}

** $Râ‚$ principle
  Some definitions:
  1. $R^{-1}[E] â‰” \{x : âˆƒyâˆˆE. xRy\}$. $E$ denotes a set.
  2. $Râ‚“^{-1}[E]â‰”R^{-1}[E]âˆ©R[x]$. $E$ denotes a set.

  The $R_1$ principle reads as follows:
  \[A â–· B â†’ (Â¬(A â–· Â¬C)âˆ§ (Dâ–·â™¢E))â–·(Bâˆ§â–¡Câˆ§(Dâ–·E))\]

  The $R_1$ condition reads as follows:
  \begin{flalign*}
  &wRxRuS_wV, Kâˆˆğ’(x,u),Î“ \\
  â‡’\ & (âˆƒV'âŠ†V)(xS_wV',R[V']âŠ†K,(âˆ€vâˆˆV')(âˆ€câˆˆK)(vRcSâ‚“Râ‚“^{-1}[Î“]â‡’(âˆƒÎ“'âŠ†Î“)cS_vÎ“'))
  \end{flalign*}

  *Theorem*.
  $$ğ”‰âŠ¨Râ‚â‡”ğ”‰âŠ¨(Râ‚)_{gen}$$

  /proof/.
  {{{red(proved in Agda)}}}
  # 1. If $ğ”‰âŠ­(Râ‚)_{gen}$ then $ğ”‰âŠ¬R$ \pend.
  - \boxed{â‡’} Assume for a contradiction that $ğ”‰âŠ­(Râ‚)_{gen}$. It follows that there exist $w,x,u,V,K,Î“$ such that $wRxRuS_wV$, $Kâˆˆğ’(x,u)$ and: \[(âˆ€V'âŠ†V)(xS_wV',
    R[V']âŠ†Kâ‡’ (âˆƒvâˆˆV')(âˆƒcâˆˆK)(vRcS_xR_x^{-1}[Î“], (âˆ€Î“'âŠ†Î“) c\cancel{S}_v Î“'))\]

    Let $ğ’±$ be a family of sets defined thus:
    \[ğ’±â‰” \{U : UâŠ†V, xS_wU,R[U]âŠ†K\}\]

    From the condition it follows that for every $Uâˆˆğ’±$ the following is valid:
    \[(âˆƒv_UâˆˆU)(âˆƒc_UâˆˆK)(v_URc_US_xR_x^{-1}[Î“],(âˆ€Î“'âŠ†Î“) c_U\cancel{S}_{v_U} Î“')\]

    Let us fix such $v_U$ and $c_U$ for all $Uâˆˆğ’±$.

    Define a valuation such that the following applies:
    \begin{flalign*}
    [âŠ©a] & \{u\} \\
    [âŠ©b] &= V \\
    [âŠ©c] &= K \\
    [âŠ©d] &= \{c_U:Uâˆˆğ’±\} \\
    [âŠ©e] &= Î“
    \end{flalign*}

    By assumption we have $w âŠ© a â–· b â†’ (Â¬(aâ–·Â¬c)âˆ§(dâ–·â™¢e))â–·(bâˆ§â–¡câˆ§(dâ–·e))$.

    It is easy to see that $w âŠ© a â–· b$ and $x âŠ© Â¬(a â–· Â¬c)$.

    Let us prove $x âŠ© dâ–·â™¢e$. Let $xRcâŠ© D$. Then $c = c_U$ for some $U âˆˆ ğ’±$. From
    the definition of $c_U$ we have $c_U S_x R_x^{âˆ’1} [Î“]$, a forcing is defined
    such that $e$ is true exactly on the set $Î“$. Hence $R_x^{-1}[Î“]âŠ©â™¢e$ and thus
    $x âŠ© dâ–·â™¢e$.

    We can also check that for $U âˆˆ ğ’±$ we have $UâŠ© b âˆ§ â–¡c$ and the following
    following condition holds for any set $U$:
    \begin{flalign*}
      (â‹†)\ xS_wU ,UâŠ© b âˆ§ â–¡câ‡’Uâˆˆ ğ’±
    \end{flalign*}
    Then since $wâŠ©aâ–·b$ and $wRxâŠ©(aâ—c)âˆ§(dâ–·â™¢e)$ there must exist some set $U$
    such that $xS_wUâŠ©bâˆ§â–¡câˆ§(dâ–·e)$. From $(â‹†)$ follows that that $Uâˆˆğ’±$ hence
    there exist $v_U,c_U$ such that $v_URc_US_xR_x^{-1}[Î“],(âˆ€Î“'âŠ†Î“)
    c_U\cancel{S}_{v_U} Î“'$. Since $c_UâŠ©d$ there must exist some $Z$ such that
    $c_US_{v_U}ZâŠ©e$, however, by the definition of the valuation it follows
    that $ZâŠ†Î“$ and thus $c_U\cancel{S}_{v_U} Z$, which is a contradiction.
  - \boxed{â‡} Suppose the $ğ”‰âŠ« (R_1)_{gen}$ and prove that $ğ”‰âŠ«R_1$. Let's fix the
    model and let $w âˆˆ W$ be arbitrary. Suppose $wâŠ© A â–·B$, and let $x$ be such
    that $wRx$ and $xâŠ© Â¬(A â–· Â¬C) âˆ§ (D â–· â™¢E)$. It follows from $x âŠ©Â¬(A â–·Â¬C)$ that
    there exists $u$ such that $xRu$, such that $uâŠ©A$, and for every $Z$ such
    that $uS_x Z$ there is some $c_Z âˆˆ Z$ such that $c_Z âŠ©C$. From $wRu$, $wâŠ©
    Aâ–· B$ and $uâŠ© A$ follows in particular that there is a $V$, $uS_w V âŠ©B$.
    Let $K â‰” \{c_Z: uS_x Z\}$. It is easy to check that $K âˆˆ ğ’(x, u)$. Let $Î“ â‰”
    [âŠ©E]$ (set of worlds that force $E$). For the selected $w, x, u, V, K, Î“$
    the property $(R 1)_{gen}$ implies that there exists $V' âŠ† V$ such that:

    \[xS_wV',R[V']âŠ†K ,(âˆ€vâˆˆV')(âˆ€câˆˆK)(vRcS_xR_x^{-1}[Î“]â‡’(âˆƒÎ“'âŠ†Î“)cS_vÎ“')\]

    We have that $V' âŠ©B$ since $V'âŠ†V$ and $V'âŠ©â–¡ C$ since $R[V']âŠ†K$. We now show
    that $V'âŠ© Dâ–· E$. Assume that for some $c âˆˆ R [V']$ we have $câŠ© D$. From
    earlier we have $xâŠ© D â–· â™¢E$. Since $c âˆˆ R [V '] âŠ† C âŠ† R [x]$, then $xRc$ so
    it follows that there exists $U$ such that $cS_x U$ and $UâŠ©â™¢E$. Clearly
    $UâŠ†[â™¢E]_x$ and also $[â™¢E]_xâŠ†R[x]$, hence by monotonicity we have
    $cS_x[â™¢E]_x$ which is the same as $cS_x R_x^{âˆ’1}[Î“]$ so by the above
    property there exists $Î“'âŠ†Î“$ such that $cS_v Î“'$. Because $Î“'âŠ†Î“$ we have
    $Î“'âŠ©E$.

# \newpage
** $RÂ¹$ principle

   The $RÂ¹$ principle reads as follows:
   \[A â–· B â†’ (â™¢Â¬(D â–· Â¬C)âˆ§ (Dâ–·A))â–·(Bâˆ§â–¡C)\]

   The $(RÂ¹)_{gen}$ condition reads as follows:
   \begin{flalign*}
   &âˆ€w,x,y,z,ğ”¸,ğ”¹,â„‚,ğ”». \\
   &wRxRyRz, \\
   & (âˆ€u.Rwu,uâˆˆğ”¸â‡’âˆƒV.SwuV,VâŠ†ğ”¹), & \text{ensures } wâŠ©Aâ–·B \\
   & (âˆ€u.Rxu,uâˆˆğ”»â‡’âˆƒV.SxuV,VâŠ†ğ”¸), & \text{ensures } xâŠ©Dâ–·A \\
   & (âˆ€V.SyzVâ‡’âˆƒv.vâˆˆV,vâˆˆâ„‚),       &  \text{ensures } yâŠ©Â¬(Dâ–·Â¬C) \\
   & zâˆˆğ”» \\
   â‡’\ & âˆƒVâŠ†ğ”¹.xS_wV,R[V]âŠ†â„‚
   \end{flalign*}

   \begin{theorem}
   $$ğ”‰âŠ¨RÂ¹â‡”ğ”‰âŠ¨(RÂ¹)_{gen}$$
   \end{theorem}

   /proof/.
   {{{red(proved in Agda)}}}
   - \boxed{â‡’} Fix a frame $F$ and let $a,b,c,d$ be propositional variables and
     assume $FâŠ©a â–· b â†’ (â™¢Â¬(d â–· Â¬c)âˆ§ (dâ–·a))â–·(bâˆ§â–¡c)$. Assume that the left part of
     the implication of $(RÂ¹)_{gen}$ holds. Now let $V$ be a valuation defined by
     \begin{flalign*}
      V(u)âŠ©a &â‡” uâˆˆğ”¸ \\
      V(u)âŠ©b &â‡” uâˆˆğ”¹ \\
      V(u)âŠ©c &â‡” uâˆˆâ„‚ \\
      V(u)âŠ©d &â‡” uâˆˆğ”»
     \end{flalign*}
     Now one can easily check that $wâŠ©Aâ–·B$, $xâŠ©â™¢Â¬(Dâ–·Â¬C)âˆ§(Dâ–·A)$, hence there exists $U$
     such that $xS_wU$ and $UâŠ©Bâˆ§â–¡C$. From that we derive that $UâŠ†ğ”¹$ and $R[U]âŠ†â„‚$.
   - \boxed{â‡} Fix a model $M$ and a world $w$, we are to prove that $wâŠ©A â–· B â†’
     (â™¢Â¬(D â–· Â¬C)âˆ§ (Dâ–·A))â–·(Bâˆ§â–¡C)$. For that assume that $wâŠ©Aâ–·B$ and that for some
     $x,y,z$ we have $wRxRyRz$ and $xâŠ©Dâ–·A$, $yâŠ©Â¬(Dâ–·Â¬C)$, $zâŠ©D$. Now let
     $ğ”¸â‰”\{w:wâŠ©A\}$. We define $ğ”¹,â„‚,ğ”»$ likewise for formulas $B,C,D$ respectively.
     It is routine to check that the left part of the implication of $(RÂ¹)_{gen}$
     is met. Hence there exist a set $VâŠ†ğ”¹$ such that $xS_wV$ and $R[V]âŠ†â„‚$. By the
     definition of the sets $ğ”¹$ and $â„‚$ it follows that $VâŠ©Bâˆ§â–¡C$.

** Other principles
   Additionally, I have proved in Agda the frame condition for the following
   principles:
   - Ordinary semantics: $M$.
   - Generalized semantics: $M,R,Pâ‚€$.
