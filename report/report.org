#+latex_compiler: xelatex
#+latex_class: article
#+title: Interpretability logics
#+author: Jan Mas Rovira, Luka Mikec, Joost J. Joosten
#+subtitle: Master's thesis
#+options: toc:nil

#+latex_header: \usepackage{hyperref}
#+latex_header: \usepackage{graphicx}
#+latex_header: \usepackage{unicode-math}
#+latex_header: \usepackage{fontspec}
#+latex_header: \usepackage[x11names, table]{xcolor}
#+latex_header: \usepackage[margin=2.5cm]{geometry}
#+latex_header: \usepackage{lmodern}
#+latex_header: \setmonofont{FreeMono}
#+latex_header: \usepackage{cancel}
#+latex_header: \usepackage{amsthm}
#+latex_header: \usepackage{float}
#+latex_header: \usepackage{newunicodechar}
#+latex_header: \usepackage[toc,indexonlyfirst,docdef=restricted]{glossaries-extra}
#+latex_header: \usepackage[style=ieee]{biblatex}
#+latex_header: \usepackage{multicol}

#+latex_header: \bibliography{refs}
#+latex_header: \makeglossaries

#+latex_header: \hypersetup{colorlinks=true,urlcolor=DodgerBlue4,linkcolor=Firebrick4,citecolor=Green4}
#+latex_header: \newcommand{\ie}[0]{i.e.\ }
#+latex_header: \newcommand{\todo}[0]{\textcolor{red}{pending}}
#+latex_header: \newcommand{\pend}[0]{\textcolor{Tomato3}{pending }}
#+latex_header: \newcommand{\ok}[0]{\textcolor{DeepSkyBlue4}{solved }}
#+macro: red @@latex:{\color{red}@@$1@@latex:}@@
#+macro: jan @@latex:{\color{red}@@Jan: $1@@latex:}@@

#+macro: begindef @@latex:\begin{definition}@@
#+macro: enddef @@latex:\end{definition}@@

#+macro: begincoro @@latex:\begin{corollary}@@
#+macro: endcoro @@latex:\end{corollary}@@

#+macro: beginremark @@latex:\begin{remark}@@
#+macro: endremark @@latex:\end{remark}@@

#+macro: begintheorem @@latex:\begin{theorem}@@
#+macro: endtheorem @@latex:\end{theorem}@@

#+macro: beginlemma @@latex:\begin{lemma}@@
#+macro: endlemma @@latex:\end{lemma}@@

#+macro: beginproof @@latex:\begin{proof}@@
#+macro: endproof @@latex:\end{proof}@@


#+macro: defglossary @@latex:\newglossaryentry{$1}{name=$2,description={$3}}@@
#+macro: defacronym @@latex:\newacronym{$1}{$2}{$3}@@


#+latex_header: \newtheorem{theorem}{Theorem}
#+latex_header: \theoremstyle{definition}
#+latex_header: \newtheorem{corollary}[theorem]{Corollary}
#+latex_header: \theoremstyle{definition}
#+latex_header: \newtheorem{lemma}[theorem]{Lemma}
#+latex_header: \theoremstyle{definition}
#+latex_header: \newtheorem{definition}[theorem]{Definition}
#+latex_header: \theoremstyle{definition}
#+latex_header: \newtheorem{remark}[theorem]{Remark}

#+latex_header: \newglossaryentry{agdaprf}{name={\includegraphics[height=\baselineskip]{img/agda}},description={A proof formalized in Agda}}

#+macro: beginmulticols @@latex:\begin{multicols}{$1}@@
#+macro: endmulticols @@latex:\end{multicols}@@

{{{defglossary(gvm,model,Generalized Veltman model)}}}
{{{defglossary(gvf,frame,Generalized Veltman frame)}}}
{{{defglossary(ovf,frame,Ordinary Veltman frame)}}}
{{{defglossary(ovm,model,Ordinary Veltman model)}}}
{{{defglossary(forcing-gen,{\ensuremath{âŠ©^{gen}_M}},Forcing relation for generalized semantics)}}}
{{{defglossary(forcing-ord,{\ensuremath{âŠ©^{ord}_M}},Forcing relation for ordinary semantics)}}}
{{{defglossary(choice-set,choice set,Choice set)}}}
{{{defglossary(noetherian,Noetherian,Conversely well-founded relation)}}}
#+latex_header: \newglossaryentry{dependent-pair}{name={dependent pair},description={A pair in which the type of the second component is indexed by the first component}}
#+latex_header: \newglossaryentry{sum type}{name={sum type},description={A disjunction of two ore more types}}
#+latex_header: \newglossaryentry{decidable model}{name={decidable model},description={A model whose forcing relation is decidable}}
#+latex_header: \newglossaryentry{Rel}{name={\texttt{Rel}},description={Homogeneous relation}}
#+latex_header: \newglossaryentry{REL}{name={\texttt{REL}},description={Heterogeneous relation}}
#+latex_header: \newglossaryentry{Pred}{name={\texttt{Pred}},description={A predicate or a subset}}

#+macro: agda @@latex:\gls{agdaprf}\glsadd{agdaprf}@@
#+latex_header: \newcommand{\prin}[1]{\text{$\mathsf{#1}$}}
#+latex_header: \newcommand{\kgen}[1]{\text{($\mathsf{#1}$)\textsubscript{gen}}}
#+latex_header: \newcommand{\kord}[1]{\text{($\mathsf{#1}$)\textsubscript{ord}}}

# Missing monospaced characters
#+latex_header: \setmathfont{XITS Math}
#+latex_header: \newfontfamily{\myfont}{XITS Math}
#+latex_header: \newunicodechar{ğ•}{\makebox[1em]{\myfontğ•}}
#+latex_header: \newunicodechar{ï½›}{\ensuremath{\{}}
#+latex_header: \newunicodechar{ï½}{\ensuremath{\}}}
#+latex_header: \setmathfont{Latin Modern Math}

\begin{abstract}

In this extended abstract we compute some rather involved frame conditions w.r.t. Generalised Veltman Semantics for principles of interpretability logic. All proofs have been formalised
in Agda and we briefly comment on this formalisation.

\end{abstract}

* Preliminaries
** Semantics
   In this document we consider two variants of relational semantics for
   interpretability logic similar to Kripke semantics for other modal logics.

*** Ordinary Veltman semantics
    {{{begindef}}} <<def:ordinary-frames>>
    (cite:modal-matters) An ordinary Veltman frame $F=âŸ¨W,R,SâŸ©$ is a
    structure constituted by a set of worlds $W$, a binary relation $RâŠ†WÂ²$ and a
    ternary relation $SâŠ†WÃ—WÃ—W$. We write $wRu$ instead of $âŸ¨w,uâŸ©âˆˆR$ and $uS_wv$
    instead of $âŸ¨w,u,vâŸ©âˆˆS$. The structure must satisfy the following conditions:

    1. $R$ is a transitive;
    2. $R$ is conversely well-founded. That is, there is no infinite ascending
       chain $wâ‚Rwâ‚‚Râ€¦$;
    3. if $uS_wv$ then $wRu$ and $wRv$;
    4. if $wRu$ then $uS_wu$;
    5. if $wRu$ and $uRv$ then $uS_wv$.
    6. for every $w$, $S_w$ is transitive;
    {{{enddef}}}


    {{{begindef}}} An ordinary Veltman model $M=âŸ¨F,VâŸ©$ is a structure
    constituted by an ordinary Veltman frame $F$ and a valuation $VâŠ†WÃ—Var$. If
    $F=âŸ¨W,R,SâŸ©$ we will write $M=âŸ¨W,R,S,VâŸ©$ instead of $M=âŸ¨âŸ¨W,R,SâŸ©,VâŸ©$. {{{enddef}}}

    {{{begindef}}}
    <<def:ord-forcing>>
    Given a model $M$, we define a forcing relation $\gls{forcing-ord}âŠ†W Ã— Fm$. We write
    $M,wâŠ©A$ instead of $âŸ¨w,AâŸ©âˆˆ\gls*{forcing-ord}$ or simply $wâŠ©A$ when the model is clear by
    the context. We write $wâŠ®A$ when $âŸ¨w,AâŸ©âˆ‰âŠ©_M$.
    1. $wâŠ®âŠ¥$;
    2. if $xâˆˆVar$, then $wâŠ©x$ iff $âŸ¨w,xâŸ©âˆˆV$;
    3. if $A,BâˆˆFm$, then $wâŠ©Aâ†’B$ iff if $wâŠ©A$ then $wâŠ©B$;
    4. if $A,BâˆˆFm$, then $wâŠ©Aâ–·B$ iff if $wRu$ and $uâŠ©A$ then there exists $v$ such
       that $vâŠ©B$ and $uS_wv$.
    {{{enddef}}}

    If $F$ is an ordinary Veltman frame and $A$ a formula, we write $FâŠ©A$ do
    denote that for every valuation we have $âŸ¨F,VâŸ©âŠ©A$.

    {{{begincoro}}}
    <<def:coro-ord-sem>>
    It immediately follows that:
    1. If $A,BâˆˆFm$, then $wâŠ©Aâˆ§(âˆ¨)B$ iff $wâŠ©A$ and (or) $wâŠ©B$;
    2. if $AâˆˆFm$, then $wâŠ©Â¬A$ iff $wâŠ®A$;
    3. if $AâˆˆFm$, then $wâŠ©â™¢A$ iff there exists $u$ such that $wRu$ and $uâŠ©A$;
    4. if $AâˆˆFm$, then $wâŠ©â–¡A$ iff for every $u$ such that $wRu$ we have $uâŠ©A$.
    {{{endcoro}}}
    {{{beginproof}}}
    {{{agda}}}
    {{{endproof}}}

*** Generalized Veltman semantics
    {{{begindef}}} (cite:mikec2019interpretability) A generalized Veltman frame
    $F=âŸ¨W,R,SâŸ©$ is a structure constituted by a set of worlds $W$, a binary
    relation $RâŠ†WÂ²$ and a ternary relation $SâŠ†WÃ—WÃ—(ğ’«(W)âˆ–\{âˆ…\})$. We write $wRu$
    instead of $âŸ¨w,uâŸ©âˆˆR$ and $uS_wY$ instead of $âŸ¨w,u,YâŸ©âˆˆS$. The structure must
    satisfy the following conditions :

    1. $R$ is a transitive; <<R-trans>>
    2. $R$ is conversely well-founded. That is, there is no infinite ascending
       chain $wâ‚Rwâ‚‚Râ€¦$;
    3. if $uS_wY$ then $wRu$ and for all $yâˆˆY$ we have $wRy$;
    4. if $wRu$ then $uS_w\{u\}$;
    5. if $wRu$ and $uRv$ then $uS_w\{v\}$;
    6. if $uS_wY$ and $yS_wZ_y$ for all $yâˆˆY$, then $uS_w\left(â‹ƒ_{yâˆˆY}Z_y\right)$.
    # 7. $S$ is monotone in the following sense: if $uS_wVâŠ†ZâŠ†\{u:wRu\}$ then
    #    $uS_wZ$.
    {{{enddef}}}

    {{{begindef}}}
    <<def:gen-frame>>
    A generalized Veltman model $M=âŸ¨F,VâŸ©$ is a structure
    constituted by a generalized Veltman frame $F$ and a valuation $VâŠ†WÃ—Var$.
    {{{enddef}}}
    {{{begindef}}}
    Given a model $M$, we define a forcing relation $âŠ©^{gen}_MâŠ†W Ã—
    Fm$. We use the same notation conventions as in the ordinary semantics.
    The definition is the same as Definition [[def:ord-forcing]] except for the $â–·$ case:
    4. if $A,BâˆˆFm$, then $wâŠ©Aâ–·B$ iff if $wRu$ and $uâŠ©A$ then there exists $Y$ such
       that $YâŠ©B$ and $uS_wY$. When we write $YâŠ©B$ we mean that for all $yâˆˆY$ we
       have $yâŠ©B$;
    {{{enddef}}}

    If $F$ is a generalized Veltman frame and $A$ a formula, we write $FâŠ©A$ do
    denote that for every valuation we have $âŸ¨F,VâŸ©âŠ©A$.

    {{{begincoro}}}
    Analogous results to Corollary [[def:coro-ord-sem]].
    {{{endcoro}}}
    {{{beginproof}}}
    {{{agda}}}
    {{{endproof}}}

** Logic $IL$
   The logic $IL$ encompasses all classical tautologies in the new language plus
   the following axiom schemes:
   - K: $â–¡ (A â†’ B) â†’ â–¡ A â†’ â–¡ B$
   - L: $â–¡ (â–¡ A â†’ A) â†’ â–¡ A$
   - J1: $â–¡ (A â†’ B) â†’ A â–· B$
   - J2: $A â–· B âˆ§ B â–· C â†’ A â–· C$
   - J3: $(A â–· C âˆ§ B â–· C) â†’ (A âˆ¨ B) â–· C$
   - J4: $A â–· B â†’ â™¢ A â†’ â™¢ B$
   - J5: $â™¢ A â–· A$
   Additionally it has the following rules:
   - Necessitation: if $âŠ¢_{IL}A$ then $âŠ¢_{IL}â–¡A$.
   - Modus ponens: if $Î âŠ¢_{IL}Aâ†’B$ and $Î âŠ¢_{IL}A$ then $Î âŠ¢_{IL}B$.
   - Identity: If $AâˆˆÎ $ then $Î âŠ¢_{IL}A$.


   The logic $IL$ is sound and complete with both ordinary and generalised
   Veltman semantics.

* Frame conditions
** \prin{Râ‚} principle
  The $R_1$ principle reads as follows:
  \[A â–· B â†’ (Â¬(A â–· Â¬C)âˆ§ (Dâ–·â™¢E))â–·(Bâˆ§â–¡Câˆ§(Dâ–·E))\]

*** Ordinary semantics

    The $\kord{R_1}$ frame condition reads as follows:
    \[âˆ€w,x,y,z(wRxRyS_wzâ‡’âˆ€u(zRuâ‡’yS_xu,âˆ€v(uS_xvâ‡’âˆ€m(vRmâ‡’uS_zm))))\]

    # #+caption: Ordinary frame condition for \prin{Râ‚}
    # #+name: fig:ord-Râ‚-condition
    # #+attr_latex: :float t :width 0.20\textwidth :placement [H]
    # [[file:img/wip.png]]

    {{{begintheorem}}}
    For any ordinary frame $F$, we have that $F$ satisfies the
    $\kord{R_1}$ condition iff any model based on $F$ forces every instantiation of
    the \prin{Râ‚} principle. In symbols:

    \[F âŠ¨ \kord{R_1} â‡” F âŠ© Râ‚\]
    {{{endtheorem}}}

*** Generalized semantics
    Some definitions:
    1. $R^{-1}[E] â‰” \{x : âˆƒyâˆˆE. xRy\}$. $E$ denotes a set.
    2. $Râ‚“^{-1}[E]â‰”R^{-1}[E]âˆ©R[x]$. $E$ denotes a set.


    The $(R_1)_{gen}$ condition reads as follows:
    \begin{flalign*}
    &âˆ€w,x,u,ğ”¹,â„‚,ğ”¼(wRxRuS_wğ”¹, â„‚âˆˆğ’(x,u) \\
    â‡’\ & (âˆƒğ”¹'âŠ†ğ”¹)(xS_wğ”¹',R[ğ”¹']âŠ†â„‚,(âˆ€vâˆˆğ”¹')(âˆ€câˆˆâ„‚)(vRcSâ‚“Râ‚“^{-1}[ğ”¼]â‡’(âˆƒğ”¼'âŠ†ğ”¼)cS_vğ”¼')))
    \end{flalign*}
    \begin{flalign*}
    &âˆ€w,x,u,ğ”¹,â„‚,ğ”¼(wRxRuS_wğ”¹, â„‚âˆˆğ’(x,u) \\
    â‡’\ & (âˆƒğ”¹'âŠ†ğ”¹)(xS_wğ”¹',R[ğ”¹']âŠ†â„‚,(âˆ€vâˆˆğ”¹')(âˆ€câˆˆâ„‚)(âˆƒUâŠ†Râ‚“^{-1}[ğ”¼],vRcSâ‚“U)â‡’(âˆƒğ”¼'âŠ†ğ”¼)cS_vğ”¼')))
    \end{flalign*}

    {{{begintheorem}}}
    <<theorem:Râ‚>>
    For any generalized frame $F$, we have that $F$ satisfies the
    $(Râ‚)_{gen}$ condition iff any model based on $F$ forces every instantiation of
    the \prin{Râ‚} principle. In symbols:

    \[FâŠ¨(Râ‚)_{gen}â‡”FâŠ©Râ‚\]
    {{{endtheorem}}}

    {{{beginproof}}}
    {{{agda}}}
    - \boxed{â‡’} Let's fix the model and let $w âˆˆ W$ be arbitrary. Suppose $wâŠ© A
      â–·B$, and let $x$ be such that $wRx$ and $xâŠ© Â¬(A â–· Â¬C) âˆ§ (D â–· â™¢E)$. It
      follows from $x âŠ©Â¬(A â–·Â¬C)$ that there exists $u$ such that $xRu$, such
      that $uâŠ©A$, and for every $Z$ such that $uS_x Z$ there is some $c_Z âˆˆ Z$
      such that $c_Z âŠ©C$. From $wRu$, $wâŠ© Aâ–· B$ and $uâŠ© A$ follows in particular
      that there is a $ğ”¹$, $uS_w ğ”¹ âŠ©B$. Let $â„‚ â‰” \{c_Z: uS_x Z\}$. It is easy to
      check that $â„‚ âˆˆ ğ’(x, u)$. Let $ğ”¼ â‰” [âŠ©E]$ (set of worlds that force $E$).
      For the selected $w, x, u, ğ”¹, â„‚, ğ”¼$ the property $(R 1)_{gen}$ implies
      that there exists $ğ”¹' âŠ† ğ”¹$ such that:

      \[xS_wğ”¹',R[ğ”¹']âŠ†â„‚ ,(âˆ€vâˆˆğ”¹')(âˆ€câˆˆâ„‚)(vRcS_xR_x^{-1}[ğ”¼]â‡’(âˆƒğ”¼'âŠ†ğ”¼)cS_vğ”¼')\]

      We have that $ğ”¹' âŠ©B$ since $ğ”¹'âŠ†ğ”¹$ and $ğ”¹'âŠ©â–¡ C$ since $R[ğ”¹']âŠ†â„‚$. We now show
      that $ğ”¹'âŠ© Dâ–· E$. Assume that for some $c âˆˆ R [ğ”¹']$ we have $câŠ© D$. From
      earlier we have $xâŠ© D â–· â™¢E$. Since $c âˆˆ R [ğ”¹ '] âŠ† C âŠ† R [x]$, then $xRc$ so
      it follows that there exists $U$ such that $cS_x U$ and $UâŠ©â™¢E$. Clearly
      $UâŠ†[â™¢E]_x$ and also $[â™¢E]_xâŠ†R[x]$, hence by monotonicity we have
      $cS_x[â™¢E]_x$ which is the same as $cS_x R_x^{âˆ’1}[ğ”¼]$ so by the above
      property there exists $ğ”¼'âŠ†ğ”¼$ such that $cS_v ğ”¼'$. Because $ğ”¼'âŠ†ğ”¼$ we have
      $ğ”¼'âŠ©E$.
    - \boxed{â‡} Assume for a contradiction that $FâŠ­(Râ‚)_{gen}$. It follows that
      there exist $w,x,u,ğ”¹,â„‚,ğ”¼$ such that $wRxRuS_wğ”¹$, $â„‚âˆˆğ’(x,u)$ and:
      \[(âˆ€ğ”¹'âŠ†ğ”¹)\left(xS_wğ”¹', R[ğ”¹']âŠ†â„‚â‡’ (âˆƒvâˆˆğ”¹')(âˆƒcâˆˆâ„‚)(âˆƒZâŠ†R_x^{-1}[ğ”¼].vRcS_xZ,âˆ€ğ”¼'âŠ†ğ”¼.
      c\cancel{S}_v ğ”¼')\right)\]

      Let $ğ’±$ be a family of sets defined thus:
      \[ğ’±â‰” \{U : UâŠ†ğ”¹, xS_wU,R[U]âŠ†â„‚\}\]

      From the condition it follows that for every $Uâˆˆğ’±$ the following is valid:
      \[(âˆƒv_UâˆˆU)(âˆƒc_Uâˆˆâ„‚)(âˆƒZ_UâŠ†R_x^{-1}[ğ”¼](v_URc_US_xZ_U,(âˆ€ğ”¼'âŠ†ğ”¼) c_U\cancel{S}_{v_U} ğ”¼'))\]

      Let us fix such $v_U$ and $c_U$ and $Z_U$ for all $Uâˆˆğ’±$.

      Define a valuation such that the following applies:
      \begin{flalign*}
      âŸ¦aâŸ§ &= \{u\} \\
      âŸ¦bâŸ§ &= ğ”¹ \\
      âŸ¦câŸ§ &= â„‚ \\
      âŸ¦dâŸ§ &= \{c_U:Uâˆˆğ’±\} \\
      âŸ¦eâŸ§ &= ğ”¼
      \end{flalign*}

      By assumption we have $w âŠ© a â–· b â†’ (Â¬(aâ–·Â¬c)âˆ§(dâ–·â™¢e))â–·(bâˆ§â–¡câˆ§(dâ–·e))$.

      It is easy to see that $w âŠ© a â–· b$ and $x âŠ© Â¬(a â–· Â¬c)$.

      Let us prove $x âŠ© dâ–·â™¢e$. Let $xRcâŠ© D$. Then $c = c_U$ for some $U âˆˆ ğ’±$.
      From the definition of $c_U$ we have $c_U S_x Z_U$, a forcing is defined
      such that $e$ is true exactly on the set $ğ”¼$. Hence $R_x^{-1}[ğ”¼]âŠ©â™¢e$ and
      since $Z_UâŠ†R_x^{-1}[ğ”¼]$ it follows that $x âŠ© dâ–·â™¢e$.

      We can also check that for $U âˆˆ ğ’±$ we have $UâŠ© b âˆ§ â–¡c$ and the following
      following condition holds for any set $U$:
      \begin{flalign*}
        (â‹†)\ xS_wU ,UâŠ© b âˆ§ â–¡câ‡’Uâˆˆ ğ’±
      \end{flalign*}
      Then since $wâŠ©aâ–·b$ and $wRxâŠ©(aâ—c)âˆ§(dâ–·â™¢e)$ there must exist some set $U$
      such that $xS_wUâŠ©bâˆ§â–¡câˆ§(dâ–·e)$. From $(â‹†)$ follows that that $Uâˆˆğ’±$ hence
      there exist $v_U,c_U,Z_U$ such that $Z_UâŠ†R_x^{-1}[ğ”¼]$ and
      $v_URc_US_xZ_U,(âˆ€ğ”¼'âŠ†ğ”¼) c_U\cancel{S}_{v_U} ğ”¼'$. Since $c_UâŠ©d$ there must
      exist some $Y$ such that $c_US_{v_U}YâŠ©e$, however, by the definition of
      the valuation it follows that $YâŠ†ğ”¼$ and thus $c_U\cancel{S}_{v_U} Y$,
      which is a contradiction.

    {{{endproof}}}

# \newpage
** \prin{Râ¿} principle
   The \prin{R^n} principle is defined thus cite:two-new-series:
   \begin{flalign*}
   U_0 &â‰” â™¢Â¬(D_0â–·Â¬C) \\
   U_{r+1} &â‰” â™¢((Dáµ£â–·D_{r+1}) âˆ§ Uáµ£) \\
   \\
   Râ°& â‰” A â–· B â†’ Â¬ (A â–· Â¬ C) â–· B âˆ§ â–¡ C \\
   R^{n+1}& â‰” A â–· B â†’ ((D_{n}â–·A) âˆ§ U_{n}) â–· B âˆ§ â–¡ C
   \end{flalign*}
*** Ordinary semantics
    The frame condition for ordinary semantics $\kord{R^n}$ can be found in
    cite:two-new-series.

*** Generalized semantics
    The $\kgen{Râ¿}$ condition reads as follows:
    \begin{flalign*}
    &âˆ€w,xâ‚€,â€¦,x_{n-1},y,z,ğ”¸,ğ”¹,â„‚,ğ”»â‚€,â€¦,ğ”»_{n-1}.\\
    &wRx_{n-1}Râ€¦Rx_0RyRz, \\
    & (âˆ€u.wRu,uâˆˆğ”¸â‡’âˆƒV.uS_wVâŠ†ğ”¹), \\
    & (âˆ€u.x_{n-1}Ruâˆˆğ”»_{n-1}â‡’âˆƒV.uS_{x_{n-1}}VâŠ†ğ”¸), \\
    & (âˆ€iâˆˆ\{1â€¦n-1\}âˆ€u.xáµ¢Ruâˆˆğ”»_iâ‡’âˆƒV.uS_{x_i}VâŠ†ğ”»_{i+1}), \\
    & (âˆ€V.zS_yVâ‡’Vâˆ©â„‚â‰ 0),      \\
    & zâˆˆğ”»â‚€ \\
    â‡’\ & âˆƒVâŠ†ğ”¹.x_{n-1}S_wV,R[V]âŠ†â„‚
    \end{flalign*}
    {{{beginlemma}}}
    <<lemma:Râ¿>>
    Let $M$ be a model, let $x$ be a world of $M$ and let $nâˆˆâ„•$. For any $iâ‰¤n$ we have
    that if $M , x âŠ© U_i$ then there exist some worlds $y,z,xâ‚€,â€¦,x_{i}$ such that:
    1. $xáµ¢=x$;
    2. $x_iRâ€¦Rxâ‚€RyRz$;
    3. for all $jâ‰¤i$ we have that $M,x_jâŠ©U_j$;
    4. for all $j<i$ we have that $M,x_jâŠ©D_jâ–·D_{j+1}$;
    5. for all $V$ we have that if $zS_yV$ then $Vâˆ©\{w:M,wâŠ©C\}â‰ âˆ…$;
    6. $M,zâŠ©Dâ‚€$.
    {{{beginproof}}}
    {{{agda}}}

    By induction on $i$.
    - For $i=0$ we have that $xâŠ©â™¢Â¬(Dâ‚€â–·Â¬C)$. It follows that there exists some
      $y$ such that $xRyâŠ©Â¬(Dâ‚€â–·Â¬C)$ and therefore there exists some $z$ such that
      $yRzâŠ©Dâ‚€$ and for any $V$, if $zS_yV$, then $Vâˆ©\{w:M,wâŠ©C\}â‰ âˆ…$. It is clear
      that all claims are met.
    - For $i+1$ we have that $xâŠ©â™¢(D_iâ–·D_{i+1}âˆ§U_i)$. It follows that there
      exists some $x_{i}$ such that $x_iâŠ©D_iâ–·D_{i+1}âˆ§U_i$. By IH there exist
      $y,z,xâ‚€,â€¦,x_{i}$ such that satisfy claims $1â€¦6$. We set $x_{i+1}â‰”x$. It is
      trivial to observe that by using the IH all conditions are met for $i+1$.
    {{{endproof}}}
    {{{endlemma}}}
    {{{begintheorem}}}
    <<theorem:Râ¿>>
    For any generalized frame $F$, we have that $F$ satisfies
    the $\kgen{Râ¿}$ condition iff any model based on $F$ forces every
    instantiation of the \prin{Râ¿} principle. In symbols:

    \[FâŠ¨\kgen{Râ¿}â‡”FâŠ©Râ¿\]
    {{{endtheorem}}}

    {{{beginproof}}}
    {{{agda}}}

    If $n=0$ we refer to theorem $R^0$ (cite something). For $n+1$ proceed as follows.
    - \boxed{â‡’} Fix a model and assume that for some world $w$ we have $wâŠ©Aâ–·B$.
      Then assume also that $wRxâŠ©((Dâ‚™â–·A)âˆ§U_n)$. By lemma [[lemma:Râ¿]] it follows
      that there exist $y,z,xâ‚€,â€¦,x_{n}$ satisfying $1â€¦6$. Then let $ğ”¸â‰”âŸ¦AâŸ§$,
      $ğ”¹â‰”âŸ¦BâŸ§$, $â„‚â‰”âŸ¦CâŸ§$ and for $iâ‰¤n$ let $ğ”»áµ¢â‰”âŸ¦Dáµ¢âŸ§$. It is routine to check that
      the left part of the $(R^{n+1})_{gen}$ holds and thus we get that there exists
      some $VâŠ†ğ”¹$ such that $x_{n}S_wV$ and $R[V]âŠ†â„‚$. Since $VâŠ†ğ”¹$ we have that
      $x_{n}âŠ©B$ and since $R[V]âŠ†â„‚$ we have $x_{n}âŠ©â–¡C$. Finally, since
      $x_{n}=x$ we conclude $xâŠ©Bâˆ§â–¡C$.
    - \boxed{â‡} Fix a frame $F$ and let $a,b,c,dâ‚€,â€¦,dâ‚™$ be propositional
      variables and assume $FâŠ©R^{n+1}$. Assume that the left part of the
      implication of $(R^{n+1})_{gen}$ holds. Now consider a model based on $F$
      that satisfies the following:
      \begin{flalign*}
       âŸ¦aâŸ§ &= ğ”¸ \\
       âŸ¦bâŸ§ &= ğ”¹ \\
       âŸ¦câŸ§ &= â„‚ \\
       âŸ¦dáµ¢âŸ§ &= ğ”»áµ¢, \text{ for all } iâˆˆ\{0â€¦n\}
      \end{flalign*}
      Now one can routinely check that $wâŠ©Aâ–·B$ and $xâŠ©((D_nâ–·A)âˆ§U_n)$, hence there
      exists $U$ such that $xS_wU$ and $UâŠ©Bâˆ§â–¡C$. From that we derive that $UâŠ†ğ”¹$
      and $R[U]âŠ†â„‚$.
    {{{endproof}}}

